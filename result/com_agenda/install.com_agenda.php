<?php
	/*
	** Generated by Joomla Admin Generator
	** Author: Le Dinh Thuong
	** Email: navaroiss@gmail.com
	** 
	** Component:  com_agenda
	** Controller: Controller
	** File: install.com_agenda.php
	** Time: Tue, 17 Nov 2009 16:19:09
	*/
// no direct access
defined( '_JEXEC' ) or die( 'Restricted access' );

function com_install()
{
	global $mainframe;
	$db =& JFactory::getDBO();
	$db_prefix = $mainframe->getCfg('dbprefix');
	$result = _runQueries($db);
	if(count($result)>=1)
	{
		foreach($result as $msg)
		{
			echo $msg."<br/>\n";
		}
	}else{
		echo "Install Component Success";
	}
}

function _runQueries($db)
{
	
$installQueries[] = 'DROP TABLE IF EXISTS `#__agenda_category`';
$installQueries[] = 'CREATE TABLE `#__agenda_category` ( `id`  int(11) auto_increment, `name`  varchar(255), `value`  text, `parent`  int(11),PRIMARY KEY  (`id`))ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8';
$installQueries[] = 'DROP TABLE IF EXISTS `#__agenda_event`';
$installQueries[] = 'CREATE TABLE `#__agenda_event` ( `id`  int(11) auto_increment, `title`  varchar(250), `date`  date, `content`  text, `image`  varchar(255), `document`  varchar(255), `icon`  varchar(255), `catid`  int(11),PRIMARY KEY  (`id`))ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8';
	$msg = array();
	if( count($installQueries) >=1 )
	{
		foreach ( $installQueries as $query ) {
			$db->setQuery( $query );
			$db->query();
			if ( $db->getErrorNum() ) {
				$msg[] = '<br/>' . $db->stderr();
			}
		}
	}
	return $msg;
}

